import pytest
import numpy as np
from matplotlib import figure as mpfig
from plantcv.plantcv.visualize import color_correction_plot


def test_color_correction_scatter():
    """Test for PlantCV."""
    colmat = (['chip_number', 'r_avg', 'g_avg', 'b_avg'],
              np.array([[1.00000000e+01, 9.25084624e-01, 9.31330432e-01, 9.24875599e-01],
                     [2.00000000e+01, 5.84148377e-02, 9.82357621e-02, 2.78593601e-01],
                     [3.00000000e+01, 5.66449842e-01, 2.14622428e-01, 6.97146957e-02],
                     [4.00000000e+01, 1.52245465e-01, 9.10103421e-02, 6.87600418e-02],
                     [5.00000000e+01, 6.33256899e-01, 6.47542390e-01, 6.31672048e-01],
                     [6.00000000e+01, 1.35726208e-01, 2.72441387e-01, 1.16561374e-01],
                     [7.00000000e+01, 1.05152323e-01, 1.51069306e-01, 3.47459716e-01],
                     [8.00000000e+01, 4.72060773e-01, 2.63902538e-01, 2.12054846e-01],
                     [9.00000000e+01, 3.95404558e-01, 4.12794235e-01, 4.04445692e-01],
                     [1.00000000e+02, 3.58740855e-01, 9.12973622e-02, 6.38027049e-02],
                     [1.10000000e+02, 4.71290187e-01, 1.55299733e-01, 1.47334924e-01],
                     [1.20000000e+02, 1.42767560e-01, 1.90565773e-01, 2.73146458e-01],
                     [1.30000000e+02, 2.13418191e-01, 2.17058980e-01, 2.12466657e-01],
                     [1.40000000e+02, 7.25025348e-01, 5.66406165e-01, 9.67476251e-02],
                     [1.50000000e+02, 1.10989440e-01, 7.56610043e-02, 1.35953952e-01],
                     [1.60000000e+02, 1.05782520e-01, 1.33214782e-01, 6.59709548e-02],
                     [1.70000000e+02, 1.09123809e-01, 1.10440358e-01, 1.12564931e-01],
                     [1.80000000e+02, 4.48749747e-01, 1.81608873e-01, 2.92411125e-01],
                     [1.90000000e+02, 3.32768652e-01, 4.34991499e-01, 1.17930959e-01],
                     [2.00000000e+02, 2.26908138e-01, 2.28374436e-01, 3.47381721e-01],
                     [2.10000000e+02, 4.91677976e-02, 4.75455099e-02, 4.95328123e-02],
                     [2.20000000e+02, 1.11005038e-01, 2.74721949e-01, 3.99319887e-01],
                     [2.30000000e+02, 6.28196609e-01, 3.67697755e-01, 7.98633535e-02],
                     [2.40000000e+02, 2.18640710e-01, 4.18827897e-01, 3.76467468e-01]]))

    stdmat = np.array([[1.00000000e+01, 9.52941176e-01, 9.52941176e-01, 9.49019608e-01],
                    [2.00000000e+01, 2.19607843e-01, 2.39215686e-01, 5.88235294e-01],
                    [3.00000000e+01, 8.39215686e-01, 4.94117647e-01, 1.72549020e-01],
                    [4.00000000e+01, 4.50980392e-01, 3.21568627e-01, 2.66666667e-01],
                    [5.00000000e+01, 7.84313725e-01, 7.84313725e-01, 7.84313725e-01],
                    [6.00000000e+01, 2.74509804e-01, 5.80392157e-01, 2.86274510e-01],
                    [7.00000000e+01, 3.13725490e-01, 3.56862745e-01, 6.50980392e-01],
                    [8.00000000e+01, 7.60784314e-01, 5.88235294e-01, 5.09803922e-01],
                    [9.00000000e+01, 6.27450980e-01, 6.27450980e-01, 6.27450980e-01],
                    [1.00000000e+02, 6.86274510e-01, 2.11764706e-01, 2.35294118e-01],
                    [1.10000000e+02, 7.56862745e-01, 3.52941176e-01, 3.88235294e-01],
                    [1.20000000e+02, 3.84313725e-01, 4.78431373e-01, 6.15686275e-01],
                    [1.30000000e+02, 4.78431373e-01, 4.78431373e-01, 4.74509804e-01],
                    [1.40000000e+02, 9.05882353e-01, 7.80392157e-01, 1.21568627e-01],
                    [1.50000000e+02, 3.68627451e-01, 2.35294118e-01, 4.23529412e-01],
                    [1.60000000e+02, 3.41176471e-01, 4.23529412e-01, 2.62745098e-01],
                    [1.70000000e+02, 3.33333333e-01, 3.33333333e-01, 3.33333333e-01],
                    [1.80000000e+02, 7.33333333e-01, 3.37254902e-01, 5.84313725e-01],
                    [1.90000000e+02, 6.15686275e-01, 7.37254902e-01, 2.50980392e-01],
                    [2.00000000e+02, 5.21568627e-01, 5.01960784e-01, 6.94117647e-01],
                    [2.10000000e+02, 2.03921569e-01, 2.03921569e-01, 2.03921569e-01],
                    [2.20000000e+02, 3.13725490e-02, 5.21568627e-01, 6.31372549e-01],
                    [2.30000000e+02, 8.78431373e-01, 6.39215686e-01, 1.80392157e-01],
                    [2.40000000e+02, 4.03921569e-01, 7.41176471e-01, 6.66666667e-01]])

    ccmat = (['chip_number', 'r_avg', 'g_avg', 'b_avg'],
             np.array([[1.00000000e+01, 9.28166971e-01, 9.55621071e-01, 9.52651037e-01],
                    [2.00000000e+01, 2.62514234e-01, 3.07741744e-01, 5.66574633e-01],
                    [3.00000000e+01, 8.22646513e-01, 4.12232673e-01, 2.33122748e-01],
                    [4.00000000e+01, 3.92637309e-01, 3.36886767e-01, 3.08899184e-01],
                    [5.00000000e+01, 7.13606938e-01, 7.64746440e-01, 7.49656044e-01],
                    [6.00000000e+01, 3.17422434e-01, 5.39660256e-01, 3.02637777e-01],
                    [7.00000000e+01, 2.92510958e-01, 3.44299374e-01, 6.26901898e-01],
                    [8.00000000e+01, 6.87194846e-01, 4.49532812e-01, 3.94421826e-01],
                    [9.00000000e+01, 5.37863260e-01, 5.87589499e-01, 5.78813546e-01],
                    [1.00000000e+02, 6.25164179e-01, 3.04129034e-01, 2.86623926e-01],
                    [1.10000000e+02, 7.24223564e-01, 3.38923986e-01, 3.55477561e-01],
                    [1.20000000e+02, 3.31589374e-01, 4.02985633e-01, 5.20283276e-01],
                    [1.30000000e+02, 4.10026986e-01, 4.37555961e-01, 4.32071381e-01],
                    [1.40000000e+02, 8.97643003e-01, 7.90263154e-01, 1.26887859e-01],
                    [1.50000000e+02, 3.43466392e-01, 3.08827429e-01, 3.98571139e-01],
                    [1.60000000e+02, 3.28837724e-01, 3.94674529e-01, 2.94033413e-01],
                    [1.70000000e+02, 3.34075842e-01, 3.55546196e-01, 3.58057622e-01],
                    [1.80000000e+02, 6.75654765e-01, 3.36712060e-01, 5.22613755e-01],
                    [1.90000000e+02, 4.92345610e-01, 6.96544839e-01, 2.30421015e-01],
                    [2.00000000e+02, 4.07225420e-01, 4.14335408e-01, 5.89514406e-01],
                    [2.10000000e+02, 2.91562544e-01, 3.07938291e-01, 3.09373391e-01],
                    [2.20000000e+02, 2.58311885e-01, 4.74656434e-01, 6.44640991e-01],
                    [2.30000000e+02, 8.47342724e-01, 5.78276943e-01, 1.85583478e-01],
                    [2.40000000e+02, 3.40649227e-01, 6.31110487e-01, 5.56800349e-01]]))
    fig, axs = color_correction_plot(colmat, stdmat, ccmat)
    assert isinstance(fig, mpfig.Figure)
